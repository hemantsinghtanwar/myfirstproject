name: Deploy to Prod Server

on:
  pull_request:
    types: [closed]

branches:
      - dev

jobs:
  deploy_to_prod:
    name: Deploy to Prod Server
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true && github.event.pull_request.base.ref == 'dev'
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2
      
    - name: Deploy to Prod Server
      run: |
        # Add commands to deploy code from dev branch on dev server to prod server
        sshpass -p "${{ secrets.DEV_PASS }}" ssh -o StrictHostKeyChecking=no -p 22456 root@103.171.45.35 "cd /var/www/html/hemant/myfirstproject && git pull origin dev && sshpass -p "${{ secrets.PROD_PASS }}" ssh -o StrictHostKeyChecking=no -p 2245 root@103.152.79.193 "cd /var/www/html/hemant/myfirstproject && git pull origin dev""
